CREATE TABLE test_defs (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    code VARCHAR(64) NOT NULL,
    version INT NOT NULL,
    title VARCHAR(128) NOT NULL,
    status VARCHAR(16) DEFAULT 'DRAFT',  -- DRAFT|PUBLISHED|ARCHIVED
    questions CLOB,
    scoring CLOB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE UNIQUE INDEX idx_test_defs_code_version ON test_defs(code, version);

CREATE TABLE test_audit (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    code VARCHAR(64) NOT NULL,
    version INT NOT NULL,
    action VARCHAR(32) NOT NULL, -- IMPORT|PUBLISH|ARCHIVE
    actor VARCHAR(64),
    snapshot CLOB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
